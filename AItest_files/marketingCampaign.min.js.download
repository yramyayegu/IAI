define(["knockout","jquery","/midtier/js/jquery.cookie.js","pubsub","/midtier/js/global.js"],function(e,t,n,r){"use strict";return{elq_mid:e.observable(),sh:e.observable(),cmid:e.observable(),s:e.observable(),lid:e.observable(),elq:e.observable(),elqaid:e.observable(),elqat:e.observable(),elqTrackId:e.observable(),elqCampaignId:e.observable(),mlid:e.observable(),sc:e.observable(),intcmp:e.observable(),setcookie_eloqua:function(e){e.elq_mid()&&t.cookie("eloqua_elq_mid",e.elq_mid(),{expires:60,path:"/",domain:"oracle.com"}),e.sh()&&t.cookie("eloqua_sh",e.sh(),{expires:60,path:"/",domain:"oracle.com"}),e.s()&&t.cookie("s",e.s(),{expires:60,path:"/",domain:"oracle.com"}),e.lid()&&t.cookie("lid",e.lid(),{expires:60,path:"/",domain:"oracle.com"}),e.elq()&&t.cookie("elq",e.elq(),{expires:60,path:"/",domain:"oracle.com"}),e.elqaid()&&t.cookie("elqaid",e.elqaid(),{expires:60,path:"/",domain:"oracle.com"}),e.elqat()&&t.cookie("elqat",e.elqat(),{expires:60,path:"/",domain:"oracle.com"}),e.elqTrackId()&&t.cookie("elqTrackId",e.elqTrackId(),{expires:60,path:"/",domain:"oracle.com"}),e.elqCampaignId()&&t.cookie("elqCampaignId",e.elqCampaignId(),{expires:60,path:"/",domain:"oracle.com"})},set_ordercookie_mcc:function(e){var n=t.cookie("Order_MarketingTrigger");e.sc()&&(t.cookie("Order_MarketingCampaignSuccess",e.sc(),{expires:30,path:"/",domain:"oracle.com"}),t.cookie("Order_MarketingInfluencer",e.sc(),{expires:30,path:"/",domain:"oracle.com"}),typeof n!="undefined"&&n!==""?(t.cookie.raw=!0,t.cookie("p_mcc",e.sc()+":"+n+":"+e.sc(),{expires:30,path:"/",domain:"oracle.com"})):(t.cookie.raw=!0,t.cookie("p_mcc",e.sc()+":"+"NA"+":"+e.sc(),{expires:30,path:"/",domain:"oracle.com"}))),e.cmid()&&(t.cookie("Order_MarketingCampaignSuccess",e.cmid(),{expires:30,path:"/",domain:"oracle.com"}),t.cookie("Order_MarketingInfluencer",e.cmid(),{expires:30,path:"/",domain:"oracle.com"}),typeof n!="undefined"&&n!==""?(t.cookie.raw=!0,t.cookie("p_mcc",e.cmid()+":"+n+":"+e.cmid(),{expires:30,path:"/",domain:"oracle.com"})):(t.cookie.raw=!0,t.cookie("p_mcc",e.cmid()+":"+"NA"+":"+e.cmid(),{expires:30,path:"/",domain:"oracle.com"})));if(e.intcmp()){typeof n!="undefined"&&n!==""?t.cookie("Order_MarketingCampaignSuccess",e.intcmp(),{expires:30,path:"/",domain:"oracle.com"}):(t.cookie("Order_MarketingCampaignSuccess",e.intcmp(),{expires:30,path:"/",domain:"oracle.com"}),t.cookie("Order_MarketingTrigger",e.intcmp(),{expires:30,path:"/",domain:"oracle.com"}));var r=t.cookie("Order_MarketingInfluencer");typeof r!="undefined"&&r!==""?typeof n!="undefined"&&n!==""?(t.cookie.raw=!0,t.cookie("p_mcc",r+":"+n+":"+e.intcmp(),{expires:30,path:"/",domain:"oracle.com"})):(t.cookie.raw=!0,t.cookie("p_mcc",r+":"+e.intcmp()+":"+e.intcmp(),{expires:30,path:"/",domain:"oracle.com"})):typeof n!="undefined"&&n!==""?(t.cookie.raw=!0,t.cookie("p_mcc","NA:"+n+":"+e.intcmp(),{expires:30,path:"/",domain:"oracle.com"})):(t.cookie.raw=!0,t.cookie("p_mcc","NA:"+e.intcmp()+":"+e.intcmp(),{expires:30,path:"/",domain:"oracle.com"}))}},setcookie_metalizer:function(e){e.mlid()&&t.cookie("mlid",e.mlid(),{expires:60,path:"/",domain:"oracle.com"})},beforeAppear:function(e){var n=this,r=Global.getParameterByName("elq_mid"),i=Global.getParameterByName("sh"),s=Global.getParameterByName("cmid"),o=Global.getParameterByName("s"),u=Global.getParameterByName("lid"),a=Global.getParameterByName("elq"),f=Global.getParameterByName("elqaid"),l=Global.getParameterByName("elqat"),c=Global.getParameterByName("elqTrackId"),h=Global.getParameterByName("elqCampaignId"),p=Global.getParameterByName("mlid"),d=Global.getParameterByName("sc"),v=Global.getParameterByName("intcmp"),m=document.referrer.split("/")[2],g;t.getJSON("/midtier/json/seoValues.json",function(e){g=e;var n=g[m];typeof n!="undefined"&&n!==""&&(t.cookie.raw=!0,t.cookie("p_mcc",n,{expires:30,path:"/",domain:"oracle.com"}))}),typeof r!="undefined"&&r!==""&&(r=n.cleanSpecialChar(r),n.elq_mid(r)),typeof i!="undefined"&&i!==""&&(i=n.cleanSpecialChar(i),n.sh(i)),typeof s!="undefined"&&s!==""&&(s=n.cleanSpecialChar(s),n.cmid(s)),typeof o!="undefined"&&o!==""&&(o=n.cleanSpecialChar(o),n.s(o)),typeof u!="undefined"&&u!==""&&(u=n.cleanSpecialChar(u),n.lid(u)),typeof a!="undefined"&&a!==""&&(a=cleanSpecialChar(a),n.elq(a)),typeof f!="undefined"&&f!==""&&(f=n.cleanSpecialChar(f),n.elqaid(f)),typeof l!="undefined"&&l!==""&&(l=n.cleanSpecialChar(l),n.elqat(l)),typeof c!="undefined"&&c!==""&&(c=n.cleanSpecialChar(c),n.elqTrackId(c)),typeof h!="undefined"&&h!==""&&(h=n.cleanSpecialChar(h),n.elqCampaignId(h)),typeof p!="undefined"&&p!==""&&(p=n.cleanSpecialCharMlid(p),n.mlid(p)),typeof d!="undefined"&&d!==""&&(d=n.cleanSpecialChar(d),n.sc(d)),typeof v!="undefined"&&v!==""&&(v=n.cleanSpecialChar(v),n.intcmp(v)),n.setcookie_eloqua(n),n.setcookie_metalizer(n),(n.sc()||n.cmid()||n.intcmp())&&n.set_ordercookie_mcc(n)},cleanSpecialChar:function(e){var n="";return t.Topic(r.topicNames.SEARCH_RESULTS_UPDATED).subscribe(function(t){var r=t.requestor.contextData.page.repositoryId;r==="searchResultsPage"&&(console.log("Inside Marketing Campaign search...."),n=e.replace(/[^A-Z0-9[\]a-z/]/g,""))}),n===""&&(n=e.replace(/[^A-Z0-9[\]a-z/]/g,"")),n},cleanSpecialCharMlid:function(e){var t="";return t===""&&(t=e.replace(/[^A-Z0-9[\].a-z/]/g,"")),t}}})