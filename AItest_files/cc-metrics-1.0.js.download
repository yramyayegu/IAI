define(["jquery","pubsub"],function(e,g){return new function(){var a=this,d=g.topicNames||{},f=function(b,a){window._eeq=window._eeq||[];var c;3==b?(c=a,c.type=b):c={type:b,data:a||{}};_eeq.push(c)};a.cartAddSuccess=function(b){b=b||{};var a=b.childSKUs&&b.childSKUs[0];if(a&&b.orderQuantity){var c=a.salePrice;b=[{n:1,v:""+b.orderQuantity},{n:2,v:""+a.listPrice}];c&&b.push({n:3,v:""+c});f(1,b)}};a.cartUpdated=function(b){b&&b.currency&&f(-1,b.currency)};a.pageLayoutLoaded=function(b){b=b&&b.data||
{};var a=b.page&&b.page.confirmation;if(a){b=a.priceInfo;var a=a.shoppingCart&&a.shoppingCart&&a.shoppingCart.items,c=0;a&&b&&b.currencyCode&&(e.each(a,function(a,b){c+=parseInt(b.quantity,10)}),f(2,{currencyCode:b.currencyCode,data:[{n:4,v:""+b.total},{n:1,v:""+c}]}))}};a.ccMetricMetadata=function(a){a&&a.logEEQ&&f(3,a.logEEQ)};a.ccMetricUnhook=function(){a.hooksAdded=0;e.Topic(d.CART_UPDATED).unsubscribe(a.cartUpdated);e.Topic(d.CART_ADD_SUCCESS).unsubscribe(a.cartAddSuccess);e.Topic(d.PAGE_LAYOUT_LOADED).unsubscribe(a.pageLayoutLoaded);
d.REGION_METADATA_CHANGED&&e.Topic(d.REGION_METADATA_CHANGED).unsubscribe(a.ccMetricMetadata)};a.ccMetricAddHooks=function(){a.hooksAdded||(e.Topic(d.CART_UPDATED).subscribe(a.cartUpdated),e.Topic(d.CART_ADD_SUCCESS).subscribe(a.cartAddSuccess),e.Topic(d.PAGE_LAYOUT_LOADED).subscribe(a.pageLayoutLoaded),d.REGION_METADATA_CHANGED&&e.Topic(d.REGION_METADATA_CHANGED).subscribe(a.ccMetricMetadata),a.hooksAdded=1)};a.ccMetricAddHooks()}});